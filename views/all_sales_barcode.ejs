<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/head'); -%>
    
    <style>
        @media print {
          #test {
             background-color: white;
                padding: 10px;
                box-shadow: 0 0 0 1px black;
          }
        }
    </style>
    
      
</head>

<body>
    <!--*******************
        Preloader start
    ********************-->
    <div id="preloader">
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>
    <!--*******************
        Preloader end
    ********************-->

    <!--**********************************
        Main wrapper start
    ***********************************-->
    <div id="main-wrapper">

        <!--**********************************
            Nav header start
        ***********************************-->
        <%- include('./partials/header_logo'); -%>

            <!--**********************************
            Nav header end
        ***********************************-->

            <!--**********************************
            Header start
        ***********************************-->
            <%- include('./partials/header',{titel: language.all_sales}); -%>

                <!--**********************************
            Header end ti-comment-alt
        ***********************************-->

                <!--**********************************
            Sidebar start
        ***********************************-->
                <%- include('./partials/sidebar'); -%>

                    <!--**********************************
            Sidebar end
        ***********************************-->

                    <!--**********************************
            Content body start
        ***********************************-->
                    <div class="content-body">
                        <div class="container-fluid">

                            <!-- row -->
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h4 class="card-title"><%= language.print_barcode %> </h4>
                                            <button type="button" class="btn btn-rounded btn-outline-info" onclick="history.back()"><i class="la la-undo"></i><%= language.go_back %></button>
                                        </div>
                                        <div class="card-body" >
                                            <div class="form-validation">
                                                <div class="row">

                                                    <div class="col-6">
                                                        <div class="form-group">
                                                            <label for="product_code"><%= language.product_code %> </label>
                                                            <input type="text" name="product_code" class="form-control" value="<%= alldata.sale_product[0].product_name %>" id="product_code" readonly>
                                                        </div>
                                                    </div>

                                                    <div class="col-6">
                                                        <div class="form-group">
                                                            <label class="paper_size"><%= language.paper_size %> <span class="text-red">*</span></label>
                                                            <select class="form-control" name="paper_size" id="paper_size" required>
                                                                <option value selected disabled>Select One</option>
                                                                <option value="sheet40">40 per sheet (a4) (1.799 * 1.003)</option>
                                                                <option value="sheet30">30 per sheet (2.625 * 1)</option>
                                                                <option value="sheet24">24 per sheet (a4) (2.48 * 1.334)</option>
                                                                <option value="sheet20">20 per sheet (4 * 1)</option>
                                                                <option value="sheet18">18 per sheet (a4) (2.5 * 1.835)</option>
                                                                <option value="sheet14">14 per sheet (4 * 1.33)</option>
                                                                <option value="sheet12">12 per sheet (a4) (2.5 * 2.834)</option>
                                                                <option value="sheet10">10 per sheet (4 * 2)</option>
                                                            </select>
                                                            <p id="error" class="text-red"></p>
                                                        </div>
                                                    </div>


                                                    <div class="row mt-3 mb-2">
                                                        <div class="table-responsive table-custom w-95 m-auto">
                                                            <table class="table">
                                                                <thead>
                                                                    <tr>
                                                                        <th><%= language.products %></th> 
                                                                        <th>Primary Code</th> 
                                                                        <th>Secondary Code</th>
                                                                        <th>Product Code</th>
                                                                        <th><%= language.quantity %></th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <% alldata.sale_product.forEach((purchases)=> { %>
                                                                       <tr>
                                                                        <td id="pro_name"><%= purchases.product_name %></td>
                                                                        <td id="pro_prim_code"><%= purchases.primary_code %></td>
                                                                        <td id="pro_second_code"><%= purchases.secondary_code %></td>
                                                                        <td id="pro_code"><%= purchases.product_code %></td>
                                                                        <td> <input type="number" id="printQty_<%= purchases.primary_code %><%= purchases.product_code %>" value="<%= purchases.quantity %>" required="required" min="1" class="form-control">  </td>
                                                                        <td> <select class="form-control" name="barcodes" id="barcodes_<%= purchases.primary_code %><%= purchases.product_code %>">
                                                                                <option value="primary">Primary Code</option>
                                                                                <option value="secondary">Secondary Code</option>
                                                                                <option value="product_code">Product Code</option>
                                                                            </select> 
                                                                        </td>
                                                                        
                                                                        <td>

                                                                            
                                                                            <button class="btn btn-primary" id="gen1_barcode" onclick="handleDropdownChange('<%= purchases.product_name %>', '<%= purchases.primary_code %>', '<%= purchases.secondary_code %>', '<%= purchases.product_code %>' )">
                                                                                <i class="fas fa-edit"></i>
                                                                                <%= language.generate_barcode %>
                                                                            </button>
                                                                        </td>
                                                                        </tr>
                                                                        <% }) %>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>

                                                    

                                                    <!--<div>-->
                                                    <!--    <button class="btn btn-primary" id="gen_barcode">-->
                                                    <!--        <i class="fas fa-edit"></i>-->
                                                    <!--        <%= language.generate_barcode %>-->
                                                    <!--    </button>-->
                                                    <!--</div>-->

                                                    <div>
                                                        <div class="card-header">
                                                            <h3 class="card-title">
                                                                <%= language.print_barcode %>
                                                            </h3>
                                                            <button class="btn btn-info float-right" id="barcode_print1" onclick="printDiv('test')">
                                                                <i class="fas fa-print"></i> <%= language.print %>
                                                            </button>
                                                        </div> 

                                                        <div id="test">
                                                            <div id="add_barcode" class="row g-1"></div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--**********************************
            Content body end
        ***********************************-->

                    <!--**********************************
            Footer start
        ***********************************-->
                    <%- include('./partials/footer'); -%>

                        <!--**********************************
            Footer end
        ***********************************-->

    </div>
    <!--**********************************
        Main wrapper end
    ***********************************-->

    <!--**********************************
        Scripts
    ***********************************-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.3/JsBarcode.all.min.js"></script>
         <script>

            
            function htmldata(name, qty){
                var barcodeSVG = '';
                for(i=1; i<=qty; i++){
                    barcodeSVG += '<div class="col-3 text-center border border-dark"> <h5 class="mt-3 mb-0">'+name+'</h5><svg id="barcode"></svg></div>';
                    
                }
                document.getElementById("add_barcode").innerHTML = barcodeSVG;
            }
            
            
            function handleDropdownChange(name, prim_code, sec_code, prod_code) {
               
                var qty = document.getElementById('printQty_'+prim_code+prod_code).value;
                var BarCodes = document.getElementById('barcodes_'+prim_code+prod_code).value;
                // alert(BarCodes)
                 // Create the barcode SVG element as a string
                htmldata(name, qty)
                // Render the barcode on the SVG element
                if(BarCodes == "primary"){
                  JsBarcode("#barcode", prim_code); 
                }else if(BarCodes == "secondary"){
                    JsBarcode("#barcode", sec_code); 
                }else if(BarCodes == "product_code"){
                    JsBarcode("#barcode", prod_code); 
                }
                
            
                // Insert the barcode SVG into the add_barcode element
                
            
                // alert(name + prim_code + sec_code + prod_code + Codes+qty+BarCodes);
            }
            
            
            function printDiv(divId) {
              var printContents = document.getElementById(divId).innerHTML;
              var originalContents = document.body.innerHTML;
              document.body.innerHTML = printContents;
              window.print();
              document.body.innerHTML = originalContents;
            }


            
            
        </script>
        
        <%- include('./partials/script'); -%>

        

    <!--**********************************
        Scripts end
    ***********************************-->
</body>

</html>